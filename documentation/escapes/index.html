<!doctype html><html><head><meta charset=utf-8><link rel=preload href=https://utkar-sh-ukla.github.io/testing/fonts/woff2/inria-sans-v14-latin-300.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://utkar-sh-ukla.github.io/testing/fonts/woff2/inria-sans-v14-latin-300italic.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://utkar-sh-ukla.github.io/testing/fonts/woff2/inria-sans-v14-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://utkar-sh-ukla.github.io/testing/fonts/woff2/inria-sans-v14-latin-700.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://utkar-sh-ukla.github.io/testing/fonts/woff2/inria-sans-v14-latin-italic.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://utkar-sh-ukla.github.io/testing/fonts/woff2/inria-sans-v14-latin-700italic.woff2 as=font type=font/woff2 crossorigin><title>JDBC escapes | Pgjdbc</title><meta name=viewport content="width=device-width,minimum-scale=1"><link rel=stylesheet href=https://utkar-sh-ukla.github.io/testing/sass/main.b7b74304d299448d7467b8d5ba5eabb175282e4e5090d6aa478f4c139d1cf770.css integrity="sha256-t7dDBNKZRI10Z7jVul6rsXUoLk5QkNaqR49ME50c93A="><link rel=icon href=/testing/favicon.ico><script src=https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin=anonymous referrerpolicy=no-referrer></script><script defer language=javascript type=module src=/testing/js/index.js></script></head><body><nav class=navbar role=navigation><a href=/testing id=host><img src=/testing/icons/postgreslogo.svg class=logo></a><div class=navbar__item><a href=/testing/download/ class=navbar__item__link>Download</a>
<a href=/testing/documentation/ class=navbar__item__link>Documentation</a>
<a href=/testing/community/ class=navbar__item__link>Community</a>
<a href=/testing/development/ class=navbar__item__link>Development</a></div><form id=search class=searchBox role=search><input class=searchInput type=search placeholder=Search id=search-input>
<button class=searchButton for=search-input><svg fill="#fff" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="24" height="24"><path d="M24 2.8886719C12.365714 2.8886719 2.8886719 12.365723 2.8886719 24S12.365714 45.111328 24 45.111328C29.036552 45.111328 33.664698 43.331333 37.298828 40.373047L52.130859 58.953125S55.379484 59.435984 57.396484 57.333984C59.427484 55.215984 58.951172 52.134766 58.951172 52.134766L40.373047 37.298828C43.331332 33.664697 45.111328 29.036548 45.111328 24 45.111328 12.365723 35.634286 2.8886719 24 2.8886719zM24 7.1113281C33.352549 7.1113281 40.888672 14.647457 40.888672 24S33.352549 40.888672 24 40.888672C14.647451 40.888672 7.1113281 33.352543 7.1113281 24 7.1113281 14.647457 14.647451 7.1113281 24 7.1113281z"/></svg></button></form><template id=search-result hidden><article class="search-list container flow"><h2><a class=summary-title-link></a></h2><summary class=summary></summary><div class=read-more-container><a class=read-more-link>Read More »</a></div></article></template></nav><main role=main class=main-inner><div class=doc><nav role=navigation class=sidebar><ul role=list class=flow><li role=listitem><a href=/testing/documentation/setup/>Getting Started</a></li><li role=listitem><a href=/testing/documentation/use/>Initializing the Driver</a></li><li role=listitem><a href=/testing/documentation/ssl/>Using SSL</a></li><li role=listitem><a href=/testing/documentation/query/>Issuing a Query and Processing the Result</a></li><li role=listitem><a href=/testing/documentation/callproc/>Calling Stored Functions and Procedures</a></li><li role=listitem><a href=/testing/documentation/binary-data/>Storing Binary Data</a></li><li role=listitem class=sidebar--active><a href=/testing/documentation/escapes/>JDBC escapes</a></li><li role=listitem><a href=/testing/documentation/server-prepare/>PostgreSQL™ Extensions to the JDBC API</a></li><li role=listitem><a href=/testing/documentation/thread/>Using the Driver in a Multithreaded or a Servlet Environment</a></li><li role=listitem><a href=/testing/documentation/datasource/>Connection Pools and Data Sources</a></li><li role=listitem><a href=/testing/documentation/logging/>Logging using java.util.logging</a></li><li role=listitem><a href=/testing/documentation/reading/>Further Reading</a></li></ul></nav><article class="article flow"><h1 id=jdbc-escapes>JDBC escapes</h1><p>The JDBC specification (like the ODBC specification) acknowledges the fact that
some vendor specific SQL may be required for certain RDBMS features. To aid
developers in writing portable JDBC applications across multiple database products,
a special escape syntax is used to specify the generic commands the developer
wants to be run. The JDBC driver translates these escape sequences into native
syntax for its specific database. For more information consult the
<a href=http://docs.oracle.com/javadb/10.10.1.2/ref/rrefjdbc1020262.html>Java DB Technical Documentation</a>.</p><p>The parsing of the sql statements for these escapes can be disabled using
<code>Statement.setEscapeProcessing(false)</code> .</p><p><code>Connection.nativeSQL(String sql)</code> provides another way to have escapes processed.
It translates the given SQL to a SQL suitable for the PostgreSQL™ backend.</p><p><strong>Example 8.1. Using JDBC escapes</strong></p><p>To use the JDBC escapes, you simply write your SQL replacing date/time literal
values, outer join and functions by the JDBC escape syntax. For example :</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=n>ResultSet</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>st</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>(</span><span class=s>&#34;SELECT {fn week({d &#39;2005-01-24&#39;})}&#34;</span><span class=o>);</span>
</code></pre></div><p>is the portable version for</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=n>ResultSet</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>st</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>(</span><span class=s>&#34;SELECT extract(week from DATE &#39;2005-01-24&#39;)&#34;</span><span class=o>);</span>
</code></pre></div><h2 id=escape-for-like-escape-character>Escape for like escape character <a class=header-link href=#escape-for-like-escape-character><svg height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>You can specify which escape character to use in strings comparison (with <code>LIKE</code> )
to protect wildcards characters ('%' and &lsquo;_') by adding the following escape :
<code>{escape 'escape-character'}</code> . The driver supports this only at the end of the
comparison expression.</p><p>For example, you can compare string values using &lsquo;|&rsquo; as escape character to protect &lsquo;_&rsquo; :</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=n>rs</span> <span class=o>=</span> <span class=n>stmt</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>(</span><span class=s>&#34;select str2 from comparisontest where str1 like &#39;|_abcd&#39; {escape &#39;|&#39;} &#34;</span><span class=o>);</span>
</code></pre></div><h2 id=escape-for-outer-joins>Escape for outer joins <a class=header-link href=#escape-for-outer-joins><svg height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>You can specify outer joins using the following syntax: <code>{oj table (LEFT|RIGHT|FULL) OUTER JOIN (table | outer-join) ON search-condition }</code></p><p>For example :</p><div class=highlight><pre class=chroma><code class=language-java data-lang=java><span class=n>ResultSet</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>stmt</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>(</span> <span class=s>&#34;select * from {oj a left outer join b on (a.i=b.i)} &#34;</span><span class=o>);</span>
</code></pre></div><h2 id=date-time-escapes>Date-time escapes <a class=header-link href=#date-time-escapes><svg height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The JDBC specification defines escapes for specifying date, time and timestamp
values which are supported by the driver.</p><blockquote><p>date</p><blockquote><p><code>{d 'yyyy-mm-dd'}</code> which is translated to <code>DATE 'yyyy-mm-dd'</code></p></blockquote></blockquote><blockquote><p>time</p><blockquote><p><code>{t 'hh:mm:ss'}</code> which is translated to <code>TIME 'hh:mm:ss'</code></p></blockquote></blockquote><blockquote><p>timestamp</p><blockquote><p><code>{ts 'yyyy-mm-dd hh:mm:ss.f...'}</code> which is translated to <code>TIMESTAMP 'yyyy-mm-dd hh:mm:ss.f'</code>
The fractional seconds (.f&mldr;) portion of the TIMESTAMP can be omitted.</p></blockquote></blockquote><h2 id=escaped-scalar-functions>Escaped scalar functions <a class=header-link href=#escaped-scalar-functions><svg height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The JDBC specification defines functions with an escape call syntax : <code>{fn function_name(arguments)}</code> .
The following tables show which functions are supported by the PostgreSQL™ driver.
The driver supports the nesting and the mixing of escaped functions and escaped
values. The appendix C of the JDBC specification describes the functions.</p><p>Some functions in the following tables are translated but reported as not supported
because they are duplicating or changing their order of the arguments. While this
is harmless for literal values or columns, it will cause problems when using
prepared statements. For example " <code>{fn right(?,?)}</code> " will be translated to " <code>substring(? from (length(?)+1-?))</code> &ldquo;.
As you can see the translated SQL requires more parameters than before the
translation but the driver will not automatically handle this.</p><p><strong>Table 8.1. Supported escaped numeric functions</strong></p><table><thead><tr><th>function</th><th>reported as supported</th><th>translation</th><th>comments</th></tr></thead><tbody><tr><td>abs(arg1)</td><td>yes</td><td>abs(arg1)</td><td></td></tr><tr><td>acos(arg1)</td><td>yes</td><td>acos(arg1)</td><td></td></tr><tr><td>asin(arg1)</td><td>yes</td><td>asin(arg1)</td><td></td></tr><tr><td>atan(arg1)</td><td>yes</td><td>atan(arg1)</td><td></td></tr><tr><td>atan2(arg1, arg2)</td><td>yes</td><td>atan2(arg1, arg2)</td><td></td></tr><tr><td>ceiling(arg1)</td><td>yes</td><td>ceil(arg1)</td><td></td></tr><tr><td>cos(arg1)</td><td>yes</td><td>cos(arg1)</td><td></td></tr><tr><td>cot(arg1)</td><td>yes</td><td>cot(arg1)</td><td></td></tr><tr><td>degrees(arg1)</td><td>yes</td><td>degrees(arg1)</td><td></td></tr><tr><td>exp(arg1)</td><td>yes</td><td>exp(arg1)</td><td></td></tr><tr><td>floor(arg1)</td><td>yes</td><td>floor(arg1)</td><td></td></tr><tr><td>log(arg1)</td><td>yes</td><td>ln(arg1)</td><td></td></tr><tr><td>log10(arg1)</td><td>yes</td><td>log(arg1)</td><td></td></tr><tr><td>mod(arg1, arg2)</td><td>yes</td><td>mod(arg1, arg2)</td><td></td></tr><tr><td>pi(arg1)</td><td>yes</td><td>pi(arg1)</td><td></td></tr><tr><td>power(arg1, arg2)</td><td>yes</td><td>pow(arg1, arg2)</td><td></td></tr><tr><td>radians(arg1)</td><td>yes</td><td>radians(arg1)</td><td></td></tr><tr><td>rand()</td><td>yes</td><td>random()</td><td></td></tr><tr><td>rand(arg1)</td><td>yes</td><td>setseed(arg1)*0+random()</td><td>The seed is initialized with the given argument and a new random value is returned.</td></tr><tr><td>round(arg1, arg2)</td><td>yes</td><td>round(arg1, arg2)</td><td></td></tr><tr><td>sign(arg1)</td><td>yes</td><td>sign(arg1)</td><td></td></tr><tr><td>sin(arg1)</td><td>yes</td><td>sin(arg1)</td><td></td></tr><tr><td>sqrt(arg1)</td><td>yes</td><td>sqrt(arg1)</td><td></td></tr><tr><td>tan(arg1)</td><td>yes</td><td>tan(arg1)</td><td></td></tr><tr><td>truncate(arg1, arg2)</td><td>yes</td><td>trunc(arg1, arg2)</td><td></td></tr></tbody></table><p><strong>Table 8.2. Supported escaped string functions</strong></p><table><thead><tr><th>function</th><th>reported as supported</th><th>translation</th><th>comments</th></tr></thead><tbody><tr><td>ascii(arg1)</td><td>yes</td><td>ascii(arg1)</td><td></td></tr><tr><td>char(arg1)</td><td>yes</td><td>chr(arg1)</td><td></td></tr><tr><td>concat(arg1, arg2&mldr;)</td><td>yes</td><td>(arg1</td><td></td></tr><tr><td>only require the two arguments version, but supporting more arguments</td><td></td><td></td><td></td></tr><tr><td>was so easy&mldr;</td><td></td><td></td><td></td></tr><tr><td>insert(arg1, arg2, arg3, arg4)</td><td>no</td><td>overlay(arg1 placing arg4 from arg2 for arg3)</td><td>This function is not supported since it changes the order of the arguments which can be a problem (for prepared</td></tr><tr><td>statements by example).</td><td></td><td></td><td></td></tr><tr><td>lcase(arg1)</td><td>yes</td><td>lower(arg1)</td><td></td></tr><tr><td>left(arg1, arg2)</td><td>yes</td><td>substring(arg1 for arg2)</td><td></td></tr><tr><td>length(arg1)</td><td>yes</td><td>length(trim(trailing from arg1))</td><td></td></tr><tr><td>locate(arg1, arg2)</td><td>no</td><td>position(arg1 in arg2)</td><td></td></tr><tr><td>locate(arg1, arg2, arg3)</td><td>no</td><td>(arg2*sign(position(arg1 in substring(arg2 from arg3)+position(arg1 in substring(arg2 from arg3))</td><td>Not supported since the three arguments version duplicate and change the order of the arguments.</td></tr><tr><td>ltrim(arg1)</td><td>yes</td><td>trim(leading from arg1)</td><td></td></tr><tr><td>repeat(arg1, arg2)</td><td>yes</td><td>repeat(arg1, arg2)</td><td></td></tr><tr><td>replace(arg1, arg2, arg3)</td><td>yes</td><td>replace(arg1, arg2, arg3)</td><td>Only reported as supported by 7.3 and above servers.</td></tr><tr><td>right(arg1, arg2)</td><td>no</td><td>substring(arg1 from (length(arg1)+1-arg2))</td><td>Not supported since arg2 is duplicated.</td></tr><tr><td>rtrim(arg1)</td><td>yes</td><td>trim(trailing from arg1)</td><td></td></tr><tr><td>space(arg1)</td><td>yes</td><td>repeat(&rsquo; &lsquo;, arg1)</td><td></td></tr><tr><td>substring(arg1, arg2)</td><td>yes</td><td>substr(arg1, arg2)</td><td></td></tr><tr><td>substring(arg1, arg2, arg3)</td><td>yes</td><td>substr(arg1, arg2, arg3)</td><td></td></tr><tr><td>ucase(arg1)</td><td>yes</td><td>upper(arg1)</td><td></td></tr><tr><td>soundex(arg1)</td><td>no</td><td>soundex(arg1)</td><td>Not supported since it requires the fuzzystrmatch contrib module.</td></tr><tr><td>difference(arg1, arg2)</td><td>no</td><td>difference(arg1, arg2)</td><td>Not supported since it requires the fuzzystrmatch contrib module.</td></tr></tbody></table><p><strong>Table 8.3. Supported escaped date/time functions</strong></p><table><thead><tr><th>function</th><th>reported as supported</th><th>translation</th><th>comments</th></tr></thead><tbody><tr><td>curdate()</td><td>yes</td><td>current_date</td><td></td></tr><tr><td>curtime()</td><td>yes</td><td>current_time</td><td></td></tr><tr><td>dayname(arg1)</td><td>yes</td><td>to_char(arg1, &lsquo;Day&rsquo;)</td><td></td></tr><tr><td>dayofmonth(arg1)</td><td>yes</td><td>extract(day from arg1)</td><td></td></tr><tr><td>dayofweek(arg1)</td><td>yes</td><td>extract(dow from arg1)+1</td><td>We must add 1 to be in the expected 1-7 range.</td></tr><tr><td>dayofyear(arg1)</td><td>yes</td><td>extract(doy from arg1)</td><td></td></tr><tr><td>hour(arg1)</td><td>yes</td><td>extract(hour from arg1)</td><td></td></tr><tr><td>minute(arg1)</td><td>yes</td><td>extract(minute from arg1)</td><td></td></tr><tr><td>month(arg1)</td><td>yes</td><td>extract(month from arg1)</td><td></td></tr><tr><td>monthname(arg1)</td><td>yes</td><td>to_char(arg1, &lsquo;Month&rsquo;)</td><td></td></tr><tr><td>now()</td><td>yes</td><td>now()</td><td></td></tr><tr><td>quarter(arg1)</td><td>yes</td><td>extract(quarter from arg1)</td><td></td></tr><tr><td>second(arg1)</td><td>yes</td><td>extract(second from arg1)</td><td></td></tr><tr><td>week(arg1)</td><td>yes</td><td>extract(week from arg1)</td><td></td></tr><tr><td>year(arg1)</td><td>yes</td><td>extract(year from arg1)</td><td></td></tr><tr><td>timestampadd(argIntervalType, argCount, argTimeStamp)</td><td>yes</td><td>('(interval according to argIntervalType and</td><td></td></tr><tr><td>argCount)'+argTimeStamp)</td><td>an argIntervalType value of SQL_TSI_FRAC_SECOND</td><td></td><td></td></tr><tr><td>is not implemented since backend does not support it</td><td></td><td></td><td></td></tr><tr><td>timestampdiff(argIntervalType, argTimeStamp1, argTimeStamp2)</td><td>not</td><td>extract((interval according to argIntervalType) from argTimeStamp2-argTimeStamp1 )</td><td>only an argIntervalType value of SQL_TSI_FRAC_SECOND, SQL_TSI_FRAC_MINUTE, SQL_TSI_FRAC_HOUR or SQL_TSI_FRAC_DAY is supported</td></tr></tbody></table><p><strong>Table 8.4. Supported escaped misc functions</strong></p><table><thead><tr><th>function</th><th>reported as supported</th><th>translation</th><th>comments</th></tr></thead><tbody><tr><td>database()</td><td>yes</td><td>current_database()</td><td>Only reported as supported by 7.3 and above servers.</td></tr><tr><td>ifnull(arg1, arg2)</td><td>yes</td><td>coalesce(arg1, arg2)</td><td></td></tr><tr><td>user()</td><td>yes</td><td>user</td><td></td></tr></tbody></table><div class=pagination><div class=pagination__left><a title="Previous page" href=https://utkar-sh-ukla.github.io/testing/documentation/binary-data/>Storing Binary Data</a></div><div class=pagination__right><a title="Next page" href=https://utkar-sh-ukla.github.io/testing/documentation/server-prepare/>PostgreSQL™ Extensions to the JDBC API</a></div></div></article><aside class=toc><h4>JDBC escapes</h4><nav id=TableOfContents><ul><li><a href=#escape-for-like-escape-character>Escape for like escape character</a></li><li><a href=#escape-for-outer-joins>Escape for outer joins</a></li><li><a href=#date-time-escapes>Date-time escapes</a></li><li><a href=#escaped-scalar-functions>Escaped scalar functions</a></li></ul></nav></aside></div></main><footer class=footer role=contentinfo><div class=footer__item><ul role=list><li class=h3>pgJDBC</li><br><li class=h4><a href=https://jdbc.postgresql.org/documentation/publicapi/index.html>Public API</a></li><li class=h4><a href=https://www.postgresql.org/>About PostgreSQL</a></li></ul><ul role=list><li class=h3>Community</li><br><li class=h4><a href=https://github.com/pgjdbc/pgjdbc>Github</a></li><li class=h4><a href=https://postgres-slack.herokuapp.com/>Slack</a></li><li class=h4><a href=https://twitter.com/PostgreSQL>Twitter</a></li><li class=h4><a href=https://www.postgresql.org/list/pgsql-jdbc/>Mailing List</a></li></ul><ul role=list><li class=h3>More</li><br><li class=h4><a href=/testing/faq/>FAQ</a></li><li class=h4><a href=https://www.postgresql.org/about/policies/privacy/>Privacy</a></li><li class=h4><a href=/testing/license/>License</a></li></ul></div><div class=copyrights>Copyright © 1996-2022 The PostgreSQL Global Development Group</div></footer></body></html>